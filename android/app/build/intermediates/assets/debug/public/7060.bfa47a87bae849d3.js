"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7060],{79169:(w,M,d)=>{d.d(M,{N:()=>p,q:()=>c});var o=d(10467),e=d(2709);class c{constructor(C){this.southwest=C.southwest,this.center=C.center,this.northeast=C.northeast}contains(C){var h=this;return(0,o.A)(function*(){return(yield e.P.mapBoundsContains({bounds:h,point:C})).contains})()}extend(C){var h=this;return(0,o.A)(function*(){const k=yield e.P.mapBoundsExtend({bounds:h,point:C});return h.southwest=k.bounds.southwest,h.center=k.bounds.center,h.northeast=k.bounds.northeast,h})()}}var p=function(f){return f.Normal="Normal",f.Hybrid="Hybrid",f.Satellite="Satellite",f.Terrain="Terrain",f.None="None",f}(p||{})},2709:(w,M,d)=>{d.d(M,{P:()=>e});const e=(0,d(15083).F3)("CapacitorGoogleMaps",{web:()=>d.e(1190).then(d.bind(d,21190)).then(c=>new c.CapacitorGoogleMapsWeb)});e.addListener("isMapInFocus",c=>{var p;const h=document.elementFromPoint(c.x,c.y),P=(null===(p=null==h?void 0:h.dataset)||void 0===p?void 0:p.internalId)===c.mapId;e.dispatchMapEvent({id:c.mapId,focus:P})})},27060:(w,M,d)=>{d.r(M),d.d(M,{HomePage:()=>X});var o=d(10467),e=d(54438),c=d(35933),p=d(60177),f=d(60248),C=d(21626),h=d(51197),k=d(92958),P=d(13903),_=d(79169),L=d(15083),l=d(2709);class E extends HTMLElement{constructor(){super()}connectedCallback(){if(this.innerHTML="","ios"==L.Ii.getPlatform()){this.style.overflow="scroll",this.style["-webkit-overflow-scrolling"]="touch";const n=document.createElement("div");n.style.height="200%",this.appendChild(n)}}}customElements.define("capacitor-google-map",E);class S{constructor(n){this.element=null,this.resizeObserver=null,this.handleScrollEvent=()=>this.updateMapBounds(),this.id=n}static create(n,t){return(0,o.A)(function*(){const i=new S(n.id);if(!n.element)throw new Error("container element is required");void 0===n.config.androidLiteMode&&(n.config.androidLiteMode=!1),i.element=n.element,i.element.dataset.internalId=n.id;const r=yield S.getElementBounds(n.element);if(n.config.width=r.width,n.config.height=r.height,n.config.x=r.x,n.config.y=r.y,n.config.devicePixelRatio=window.devicePixelRatio,"android"==L.Ii.getPlatform()&&i.initScrolling(),L.Ii.isNativePlatform()){n.element={};const s=()=>{var v,b;const T=null!==(b=null===(v=i.element)||void 0===v?void 0:v.getBoundingClientRect())&&void 0!==b?b:{};return{x:T.x,y:T.y,width:T.width,height:T.height}},a=()=>{l.P.onDisplay({id:i.id,mapBounds:s()})},u=()=>{l.P.onResize({id:i.id,mapBounds:s()})},g=i.element.closest(".ion-page");"ios"===L.Ii.getPlatform()&&g&&(g.addEventListener("ionViewWillEnter",()=>{setTimeout(()=>{a()},100)}),g.addEventListener("ionViewDidEnter",()=>{setTimeout(()=>{a()},100)}));const y={width:r.width,height:r.height,isHidden:!1};i.resizeObserver=new ResizeObserver(()=>{if(null!=i.element){const v=i.element.getBoundingClientRect(),b=0===v.width&&0===v.height;b||(y.isHidden?"ios"===L.Ii.getPlatform()&&!g&&a():(y.width!==v.width||y.height!==v.height)&&u()),y.width=v.width,y.height=v.height,y.isHidden=b}}),i.resizeObserver.observe(i.element)}if(yield new Promise((s,a)=>{setTimeout((0,o.A)(function*(){try{yield l.P.create(n),s(void 0)}catch(u){a(u)}}),200)}),t){const s=yield l.P.addListener("onMapReady",a=>{a.mapId==i.id&&(t(a),s.remove())})}return i})()}static getElementBounds(n){return(0,o.A)(function*(){return new Promise(t=>{let i=n.getBoundingClientRect();if(0==i.width){let r=0;const s=setInterval(function(){0==i.width&&r<30?(i=n.getBoundingClientRect(),r++):(30==r&&console.warn("Map size could not be determined"),clearInterval(s),t(i))},100)}else t(i)})})()}enableTouch(){var n=this;return(0,o.A)(function*(){return l.P.enableTouch({id:n.id})})()}disableTouch(){var n=this;return(0,o.A)(function*(){return l.P.disableTouch({id:n.id})})()}enableClustering(n){var t=this;return(0,o.A)(function*(){return l.P.enableClustering({id:t.id,minClusterSize:n})})()}disableClustering(){var n=this;return(0,o.A)(function*(){return l.P.disableClustering({id:n.id})})()}addMarker(n){var t=this;return(0,o.A)(function*(){return(yield l.P.addMarker({id:t.id,marker:n})).id})()}addMarkers(n){var t=this;return(0,o.A)(function*(){return(yield l.P.addMarkers({id:t.id,markers:n})).ids})()}removeMarker(n){var t=this;return(0,o.A)(function*(){return l.P.removeMarker({id:t.id,markerId:n})})()}removeMarkers(n){var t=this;return(0,o.A)(function*(){return l.P.removeMarkers({id:t.id,markerIds:n})})()}addPolygons(n){var t=this;return(0,o.A)(function*(){return(yield l.P.addPolygons({id:t.id,polygons:n})).ids})()}addPolylines(n){var t=this;return(0,o.A)(function*(){return(yield l.P.addPolylines({id:t.id,polylines:n})).ids})()}removePolygons(n){var t=this;return(0,o.A)(function*(){return l.P.removePolygons({id:t.id,polygonIds:n})})()}addCircles(n){var t=this;return(0,o.A)(function*(){return(yield l.P.addCircles({id:t.id,circles:n})).ids})()}removeCircles(n){var t=this;return(0,o.A)(function*(){return l.P.removeCircles({id:t.id,circleIds:n})})()}removePolylines(n){var t=this;return(0,o.A)(function*(){return l.P.removePolylines({id:t.id,polylineIds:n})})()}destroy(){var n=this;return(0,o.A)(function*(){var t;return"android"==L.Ii.getPlatform()&&n.disableScrolling(),L.Ii.isNativePlatform()&&(null===(t=n.resizeObserver)||void 0===t||t.disconnect()),n.removeAllMapListeners(),l.P.destroy({id:n.id})})()}setCamera(n){var t=this;return(0,o.A)(function*(){return l.P.setCamera({id:t.id,config:n})})()}getMapType(){var n=this;return(0,o.A)(function*(){const{type:t}=yield l.P.getMapType({id:n.id});return _.N[t]})()}setMapType(n){var t=this;return(0,o.A)(function*(){return l.P.setMapType({id:t.id,mapType:n})})()}enableIndoorMaps(n){var t=this;return(0,o.A)(function*(){return l.P.enableIndoorMaps({id:t.id,enabled:n})})()}enableTrafficLayer(n){var t=this;return(0,o.A)(function*(){return l.P.enableTrafficLayer({id:t.id,enabled:n})})()}enableAccessibilityElements(n){var t=this;return(0,o.A)(function*(){return l.P.enableAccessibilityElements({id:t.id,enabled:n})})()}enableCurrentLocation(n){var t=this;return(0,o.A)(function*(){return l.P.enableCurrentLocation({id:t.id,enabled:n})})()}setPadding(n){var t=this;return(0,o.A)(function*(){return l.P.setPadding({id:t.id,padding:n})})()}getMapBounds(){var n=this;return(0,o.A)(function*(){return new _.q(yield l.P.getMapBounds({id:n.id}))})()}fitBounds(n,t){var i=this;return(0,o.A)(function*(){return l.P.fitBounds({id:i.id,bounds:n,padding:t})})()}initScrolling(){const n=document.getElementsByTagName("ion-content");for(let t=0;t<n.length;t++)n[t].scrollEvents=!0;window.addEventListener("ionScroll",this.handleScrollEvent),window.addEventListener("scroll",this.handleScrollEvent),window.addEventListener("resize",this.handleScrollEvent),screen.orientation?screen.orientation.addEventListener("change",()=>{setTimeout(this.updateMapBounds,500)}):window.addEventListener("orientationchange",()=>{setTimeout(this.updateMapBounds,500)})}disableScrolling(){window.removeEventListener("ionScroll",this.handleScrollEvent),window.removeEventListener("scroll",this.handleScrollEvent),window.removeEventListener("resize",this.handleScrollEvent),screen.orientation?screen.orientation.removeEventListener("change",()=>{setTimeout(this.updateMapBounds,1e3)}):window.removeEventListener("orientationchange",()=>{setTimeout(this.updateMapBounds,1e3)})}updateMapBounds(){if(this.element){const n=this.element.getBoundingClientRect();l.P.onScroll({id:this.id,mapBounds:{x:n.x,y:n.y,width:n.width,height:n.height}})}}setOnCameraIdleListener(n){var t=this;return(0,o.A)(function*(){t.onCameraIdleListener&&t.onCameraIdleListener.remove(),t.onCameraIdleListener=n?yield l.P.addListener("onCameraIdle",t.generateCallback(n)):void 0})()}setOnBoundsChangedListener(n){var t=this;return(0,o.A)(function*(){t.onBoundsChangedListener&&t.onBoundsChangedListener.remove(),t.onBoundsChangedListener=n?yield l.P.addListener("onBoundsChanged",t.generateCallback(n)):void 0})()}setOnCameraMoveStartedListener(n){var t=this;return(0,o.A)(function*(){t.onCameraMoveStartedListener&&t.onCameraMoveStartedListener.remove(),t.onCameraMoveStartedListener=n?yield l.P.addListener("onCameraMoveStarted",t.generateCallback(n)):void 0})()}setOnClusterClickListener(n){var t=this;return(0,o.A)(function*(){t.onClusterClickListener&&t.onClusterClickListener.remove(),t.onClusterClickListener=n?yield l.P.addListener("onClusterClick",t.generateCallback(n)):void 0})()}setOnClusterInfoWindowClickListener(n){var t=this;return(0,o.A)(function*(){t.onClusterInfoWindowClickListener&&t.onClusterInfoWindowClickListener.remove(),t.onClusterInfoWindowClickListener=n?yield l.P.addListener("onClusterInfoWindowClick",t.generateCallback(n)):void 0})()}setOnInfoWindowClickListener(n){var t=this;return(0,o.A)(function*(){t.onInfoWindowClickListener&&t.onInfoWindowClickListener.remove(),t.onInfoWindowClickListener=n?yield l.P.addListener("onInfoWindowClick",t.generateCallback(n)):void 0})()}setOnMapClickListener(n){var t=this;return(0,o.A)(function*(){t.onMapClickListener&&t.onMapClickListener.remove(),t.onMapClickListener=n?yield l.P.addListener("onMapClick",t.generateCallback(n)):void 0})()}setOnPolygonClickListener(n){var t=this;return(0,o.A)(function*(){t.onPolygonClickListener&&t.onPolygonClickListener.remove(),t.onPolygonClickListener=n?yield l.P.addListener("onPolygonClick",t.generateCallback(n)):void 0})()}setOnCircleClickListener(n){var t=this;return(0,o.A)(function*(){t.onCircleClickListener&&t.onCircleClickListener.remove(),t.onCircleClickListener=n?yield l.P.addListener("onCircleClick",t.generateCallback(n)):void 0})()}setOnMarkerClickListener(n){var t=this;return(0,o.A)(function*(){t.onMarkerClickListener&&t.onMarkerClickListener.remove(),t.onMarkerClickListener=n?yield l.P.addListener("onMarkerClick",t.generateCallback(n)):void 0})()}setOnPolylineClickListener(n){var t=this;return(0,o.A)(function*(){t.onPolylineClickListener&&t.onPolylineClickListener.remove(),t.onPolylineClickListener=n?yield l.P.addListener("onPolylineClick",t.generateCallback(n)):void 0})()}setOnMarkerDragStartListener(n){var t=this;return(0,o.A)(function*(){t.onMarkerDragStartListener&&t.onMarkerDragStartListener.remove(),t.onMarkerDragStartListener=n?yield l.P.addListener("onMarkerDragStart",t.generateCallback(n)):void 0})()}setOnMarkerDragListener(n){var t=this;return(0,o.A)(function*(){t.onMarkerDragListener&&t.onMarkerDragListener.remove(),t.onMarkerDragListener=n?yield l.P.addListener("onMarkerDrag",t.generateCallback(n)):void 0})()}setOnMarkerDragEndListener(n){var t=this;return(0,o.A)(function*(){t.onMarkerDragEndListener&&t.onMarkerDragEndListener.remove(),t.onMarkerDragEndListener=n?yield l.P.addListener("onMarkerDragEnd",t.generateCallback(n)):void 0})()}setOnMyLocationButtonClickListener(n){var t=this;return(0,o.A)(function*(){t.onMyLocationButtonClickListener&&t.onMyLocationButtonClickListener.remove(),t.onMyLocationButtonClickListener=n?yield l.P.addListener("onMyLocationButtonClick",t.generateCallback(n)):void 0})()}setOnMyLocationClickListener(n){var t=this;return(0,o.A)(function*(){t.onMyLocationClickListener&&t.onMyLocationClickListener.remove(),t.onMyLocationClickListener=n?yield l.P.addListener("onMyLocationClick",t.generateCallback(n)):void 0})()}removeAllMapListeners(){var n=this;return(0,o.A)(function*(){n.onBoundsChangedListener&&(n.onBoundsChangedListener.remove(),n.onBoundsChangedListener=void 0),n.onCameraIdleListener&&(n.onCameraIdleListener.remove(),n.onCameraIdleListener=void 0),n.onCameraMoveStartedListener&&(n.onCameraMoveStartedListener.remove(),n.onCameraMoveStartedListener=void 0),n.onClusterClickListener&&(n.onClusterClickListener.remove(),n.onClusterClickListener=void 0),n.onClusterInfoWindowClickListener&&(n.onClusterInfoWindowClickListener.remove(),n.onClusterInfoWindowClickListener=void 0),n.onInfoWindowClickListener&&(n.onInfoWindowClickListener.remove(),n.onInfoWindowClickListener=void 0),n.onMapClickListener&&(n.onMapClickListener.remove(),n.onMapClickListener=void 0),n.onPolylineClickListener&&(n.onPolylineClickListener.remove(),n.onPolylineClickListener=void 0),n.onMarkerClickListener&&(n.onMarkerClickListener.remove(),n.onMarkerClickListener=void 0),n.onPolygonClickListener&&(n.onPolygonClickListener.remove(),n.onPolygonClickListener=void 0),n.onCircleClickListener&&(n.onCircleClickListener.remove(),n.onCircleClickListener=void 0),n.onMarkerDragStartListener&&(n.onMarkerDragStartListener.remove(),n.onMarkerDragStartListener=void 0),n.onMarkerDragListener&&(n.onMarkerDragListener.remove(),n.onMarkerDragListener=void 0),n.onMarkerDragEndListener&&(n.onMarkerDragEndListener.remove(),n.onMarkerDragEndListener=void 0),n.onMyLocationButtonClickListener&&(n.onMyLocationButtonClickListener.remove(),n.onMyLocationButtonClickListener=void 0),n.onMyLocationClickListener&&(n.onMyLocationClickListener.remove(),n.onMyLocationClickListener=void 0)})()}generateCallback(n){const t=this.id;return i=>{i.mapId==t&&n(i)}}}var O=d(45312),x=d(96943),A=d(7981),D=d(75507),R=d(12106),B=d(4286),j=d(3191),I=d(89417),F=d(36882);const H=["map"],N=()=>({"border-radius":"24px"}),W=()=>({"border-radius":"24px 24px 0 0"});function G(m,n){1&m&&e.nrm(0,"ion-icon",20)}function z(m,n){if(1&m){const t=e.RV6();e.j41(0,"ion-icon",21),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.clearSearch())}),e.k0s()}}function V(m,n){if(1&m){const t=e.RV6();e.j41(0,"ion-item",22),e.bIt("click",function(){const r=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.selectPlace(r))}),e.EFF(1),e.k0s()}if(2&m){const t=n.$implicit;e.R7$(),e.SpI(" ",t.description," ")}}function $(m,n){if(1&m){const t=e.RV6();e.j41(0,"ion-content",23)(1,"div")(2,"ion-label"),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"ion-segment",24),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.mapType,r)||(s.mapType=r),e.Njj(r)}),e.j41(6,"ion-segment-button",25)(7,"ion-label"),e.EFF(8),e.nI1(9,"translate"),e.k0s()(),e.j41(10,"ion-segment-button",26)(11,"ion-label"),e.EFF(12),e.nI1(13,"translate"),e.k0s()(),e.j41(14,"ion-segment-button",27)(15,"ion-label"),e.EFF(16),e.nI1(17,"translate"),e.k0s()(),e.j41(18,"ion-segment-button",28)(19,"ion-label"),e.EFF(20),e.nI1(21,"translate"),e.k0s()()()(),e.j41(22,"div",29)(23,"ion-label"),e.EFF(24),e.nI1(25,"translate"),e.k0s(),e.j41(26,"ion-segment",30),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.observationType,r)||(s.observationType=r),e.Njj(r)}),e.j41(27,"ion-segment-button",31)(28,"ion-label"),e.EFF(29),e.nI1(30,"translate"),e.k0s()(),e.j41(31,"ion-segment-button",32)(32,"ion-label"),e.EFF(33),e.nI1(34,"translate"),e.k0s()()()(),e.j41(35,"div",33)(36,"button",34),e.bIt("click",function(){e.eBV(t),e.XpG();const r=e.sdS(16);return e.Njj(r.dismiss())}),e.EFF(37),e.nI1(38,"translate"),e.k0s(),e.j41(39,"button",35),e.bIt("click",function(){e.eBV(t);const r=e.XpG(),s=e.sdS(16);return r.applyFilter(),e.Njj(s.dismiss())}),e.EFF(40),e.nI1(41,"translate"),e.k0s()()()}if(2&m){const t=e.XpG();e.R7$(3),e.JRh(e.bMT(4,12,"home.map")),e.R7$(2),e.R50("ngModel",t.mapType),e.R7$(3),e.JRh(e.bMT(9,14,"home.normal")),e.R7$(4),e.JRh(e.bMT(13,16,"home.hybrid")),e.R7$(4),e.JRh(e.bMT(17,18,"home.satellite")),e.R7$(4),e.JRh(e.bMT(21,20,"home.terrain")),e.R7$(4),e.JRh(e.bMT(25,22,"home.sounds")),e.R7$(2),e.R50("ngModel",t.observationType),e.R7$(3),e.JRh(e.bMT(30,24,"home.all")),e.R7$(4),e.JRh(e.bMT(34,26,"home.mine")),e.R7$(4),e.SpI(" ",e.bMT(38,28,"about_me.buttons.btn_cancel")," "),e.R7$(3),e.SpI(" ",e.bMT(41,30,"about_me.buttons.btn_apply")," ")}}function J(m,n){if(1&m){const t=e.RV6();e.j41(0,"ion-content")(1,"ion-toolbar")(2,"ion-title",36),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"ion-buttons",37)(6,"ion-button",38),e.bIt("click",function(){e.eBV(t),e.XpG();const r=e.sdS(25);return e.Njj(r.dismiss())}),e.nrm(7,"img",39),e.k0s()()(),e.j41(8,"div",40),e.nrm(9,"img",41),e.j41(10,"label",42),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"label",43),e.EFF(14),e.nI1(15,"translate"),e.k0s()()()}if(2&m){const t=e.XpG();e.R7$(3),e.JRh(e.bMT(4,5,"achievements_modal.new_achievements")),e.R7$(6),e.Mz_("src","assets/images/SoundCollect/lvl",t.level,".svg",e.B4B),e.R7$(2),e.JRh(e.bMT(12,7,"achievements_modal.lvl"+t.level)),e.R7$(3),e.JRh(e.bMT(15,9,"achievements_modal.arg"))}}let X=(()=>{var m;class n{constructor(i,r,s,a,u){this.locationService=i,this.commonService=r,this.modalCtl=s,this.observationsService=a,this.zone=u,this.userService=(0,e.WQX)(B.D),this.authService=(0,e.WQX)(f.uR),this.description="",this.defaultLocation={lat:41.3870154,lng:2.1700471},this.observations=[],this.polylines=[],this.markers=[],this.isOpenBadgeModal=!1,this.level=0,this.canOpenModal=!0,this.searchText="",this.predictions=[],this.mapType=_.N.Satellite,this.observationType="all",this.observationTypeShowed="all",this.userId=""}ngOnInit(){var i=this;return(0,o.A)(function*(){i.userId=(yield i.authService.getUserId())||"",yield i.locationService.requestAppPermissions(),yield i.getUserLocationAndCreateMap(),i.initAutocomplete()})()}ionViewWillEnter(){var i=this;return(0,o.A)(function*(){i.userService.notificationGaming&&(yield i.checkIsNewBadge()),i.userService.notificationGaming=!1})()}ngOnDestroy(){var i=this;return(0,o.A)(function*(){yield i.map.removeAllMapListeners()})()}initAutocomplete(){this.autocompleteService=new google.maps.places.AutocompleteService;const i=document.createElement("div");this.placesService=new google.maps.places.PlacesService(i)}getUserLocationAndCreateMap(){var i=this;return(0,o.A)(function*(){try{if(yield i.commonService.showLoader(),yield i.locationService.checkAppPermissions()){const r=yield i.locationService.getCoordinates(),s={lat:r.coords.latitude,lng:r.coords.longitude};i.initialPosition=s,yield i.createMap(s)}else i.initialPosition=i.defaultLocation,yield i.createMap(i.defaultLocation);yield i.commonService.hideLoader()}catch{yield i.createMap(i.defaultLocation),yield i.commonService.hideLoader()}})()}createMap(i){var r=this;return(0,o.A)(function*(){r.map=yield S.create({id:"map",element:r.mapElement.nativeElement,apiKey:O.c.keys.googleMaps,forceCreate:!0,config:{center:i,zoom:14,mapTypeId:"satellite"}}),yield r.map.setMapType(_.N.Satellite),yield r.map.setCamera({coordinate:i,animate:!0}),yield r.getObservationsAndCreateMarkets(),yield r.map.enableCurrentLocation(!0),yield r.map.setOnMarkerClickListener(function(){var s=(0,o.A)(function*(a){const u=r.observations.find(g=>(null==g?void 0:g.latitude)===a.latitude.toString()&&(null==g?void 0:g.longitude)===a.longitude.toString());yield r.showDetails(u.id)});return function(a){return s.apply(this,arguments)}}()),yield r.map.setOnPolylineClickListener(function(){var s=(0,o.A)(function*(a){var u;yield r.showDetails(null!==(u=a.tag)&&void 0!==u?u:"")});return function(a){return s.apply(this,arguments)}}())})()}getObservationsAndCreateMarkets(){var i=this;return(0,o.A)(function*(){try{if(i.observationTypeShowed=i.observationType,i.map.removeMarkers(i.markers),i.map.removePolylines(i.polylines),0===i.observations.length){let a=yield i.observationsService.getMapObservations();null!=a&&a.data&&(i.observations=null==a?void 0:a.data,console.log(a))}let r=[],s=[];i.observations.forEach(a=>{if("mine"===i.observationType&&i.userId===a.user_id||"all"===i.observationType)if(a.segments.length>0){a.segments.forEach(g=>{const v=i.createPolyline([{lat:+g.start_latitude,lng:+g.start_longitude},{lat:+g.end_latitude,lng:+g.end_longitude}],a.id,g.LAeq);r.push(v)});const u=i.createMarker(a.latitude,a.longitude,a.Leq);s.push(u)}else if(!a.path){const u=i.createMarker(a.latitude,a.longitude,a.Leq);s.push(u)}}),i.markers=yield i.map.addMarkers(s),i.polylines=yield i.map.addPolylines(r)}catch(r){console.log(r)}})()}createMarker(i,r,s){return{coordinate:{lat:parseFloat(i),lng:parseFloat(r)},iconUrl:this.getMarkerSVGColorByDBA(s),iconOrigin:{x:0,y:0},iconAnchor:{x:11,y:35},iconSize:{width:22,height:35}}}createPolyline(i,r,s){return{path:i,strokeColor:this.observationsService.getPolylineColorByDBA(s),strokeWeight:2,strokeOpacity:1,clickable:!0,geodesic:!0,tag:r,icons:[{icon:{path:google.maps.SymbolPath.CIRCLE},offset:"25px",repeat:"25px"}],styleSpans:[{color:"#000000",segments:2}]}}getMarkerSVGColorByDBA(i){return+i<40?"assets/images/SoundCollect/markers/35.png":+i<45?"assets/images/SoundCollect/markers/40.png":+i<50?"assets/images/SoundCollect/markers/45.png":+i<55?"assets/images/SoundCollect/markers/50.png":+i<60?"assets/images/SoundCollect/markers/55.png":+i<65?"assets/images/SoundCollect/markers/60.png":+i<70?"assets/images/SoundCollect/markers/65.png":+i<75?"assets/images/SoundCollect/markers/70.png":+i<80?"assets/images/SoundCollect/markers/75.png":+i<85?"assets/images/SoundCollect/markers/80.png":"assets/images/SoundCollect/markers/85.png"}showDetails(i){var r=this;return(0,o.A)(function*(){r.modal=yield r.modalCtl.create({component:R.ObservationDetailsPage,cssClass:"full-size-modal",componentProps:{state:{id:i}}}),!r.modal.isOpen&&r.canOpenModal&&(r.canOpenModal=!1,yield r.modal.present());const{data:s}=yield r.modal.onWillDismiss();"closed"===s&&(r.canOpenModal=!0)})()}searchLocations(){var i=this;return(0,o.A)(function*(){i.searchText&&i.searchText.length>2?yield i.autocompleteService.getPlacePredictions({input:i.searchText},(r,s)=>{s===google.maps.places.PlacesServiceStatus.OK&&(i.predictions=r)}):i.predictions=[]})()}selectPlace(i){var r=this;return(0,o.A)(function*(){r.searchText=i.description,r.predictions=[],yield r.placesService.getDetails({placeId:i.place_id},(s,a)=>{a===google.maps.places.PlacesServiceStatus.OK&&r.map.setCamera({coordinate:{lat:s.geometry.location.lat(),lng:s.geometry.location.lng()},animate:!0,zoom:16})})})()}clearSearch(){var i=this;return(0,o.A)(function*(){i.searchText="",i.predictions=[],yield i.map.setCamera({coordinate:i.initialPosition,animate:!0,zoom:14})})()}checkIsNewBadge(){var i=this;return(0,o.A)(function*(){try{i.level=yield i.userService.gamificationLevel();const r=yield i.commonService.getItem("badges");if(r){let s=JSON.parse(r);s.includes(i.level)||(i.isOpenBadgeModal=!0,s.push(i.level),yield i.commonService.setItem("badges",JSON.stringify(s)))}else i.isOpenBadgeModal=!0,yield i.commonService.setItem("badges",JSON.stringify([i.level]))}catch(r){console.log(r)}})()}applyFilter(){var i=this;return(0,o.A)(function*(){yield i.map.setMapType(i.mapType),i.observationType!=i.observationTypeShowed&&(yield i.getObservationsAndCreateMarkets())})()}optionsPopoverDismiss(){var i=this;return(0,o.A)(function*(){const r=yield i.map.getMapType();r!=i.mapType&&(i.mapType=r),i.observationType!=i.observationTypeShowed&&(i.observationType=i.observationTypeShowed)})()}}return(m=n).\u0275fac=function(i){return new(i||m)(e.rXU(x.N),e.rXU(F.h),e.rXU(c.W3),e.rXU(A.z),e.rXU(e.SKi))},m.\u0275cmp=e.VBU({type:m,selectors:[["app-home"]],viewQuery:function(i,r){if(1&i&&e.GBs(H,5),2&i){let s;e.mGM(s=e.lsd())&&(r.mapElement=s.first)}},standalone:!0,features:[e.Jv_([C.Qq,f.uR,h.h,x.N,D.g,A.z,B.D,j.q]),e.aNF],decls:27,vars:14,consts:[["map",""],["optionsPopover",""],["modal",""],[3,"fullscreen"],[2,"height","105%","position","relative"],[1,"w-full",2,"position","absolute","top","calc(20px - env(safe-area-inset-top))"],[1,"flex","flex-col","px-2","w-full","items-center","justify-center",2,"max-width","calc(100% - 47px)"],[1,"relative","w-full","margin-top-safe-area"],["type","search",1,"w-full",2,"background","#fff","padding","9px 28px 9px 16px",3,"ngModelChange","ngModel","ngClass","placeholder","ngStyle"],["class","absolute","name","search-outline","style","top: 0; bottom: 0; margin: auto; right: 13px",4,"ngIf"],["class","absolute","name","close-outline","style","top: 0; bottom: 0; margin: auto; right: 13px",3,"click",4,"ngIf"],[1,"w-full","listSearch",2,"border-radius","0 0 24px 24px",3,"hidden"],["tappable","",3,"click",4,"ngFor","ngForOf"],["id","filter-options",1,"absolute","flex","flex-row","justify-center","items-center",2,"width","44px","right","0.5rem","top","calc(env(safe-area-inset-top) + 20px) !important","height","44px","background","white","border-radius","24px","box-shadow","0 0 5px 2px rgba(0, 0, 0, 0.75)"],["size","large","name","options"],["id","options-popover","trigger","filter-options","triggerAction","click",2,"--width","96vw",3,"didDismiss"],[1,"p-2","flex","flex-col","w-full","h-full"],[1,"mx-3",2,"padding","0px 10px","border-radius","24px","display","flex","justify-content","space-between","border-radius","24px","background","-webkit-linear-gradient(\n          90deg,\n          #d9f2d0,\n          #92d050,\n          #4ea72e,\n          #ffff00,\n          #ffc000,\n          #f2aa84,\n          #ff0000,\n          #c00000,\n          #7030a0,\n          #0f9ed5,\n          #215f9a\n        )","/* chrome 10-25, safari 5.1-6 */\n        background","linear-gradient(\n          90deg,\n          #d9f2d0,\n          #92d050,\n          #4ea72e,\n          #ffff00,\n          #ffc000,\n          #f2aa84,\n          #ff0000,\n          #c00000,\n          #7030a0,\n          #0f9ed5,\n          #215f9a\n        )"],[1,"H6-14-700-SpaceGrotesk"],["id","modal-badge",3,"didDismiss","isOpen"],["name","search-outline",1,"absolute",2,"top","0","bottom","0","margin","auto","right","13px"],["name","close-outline",1,"absolute",2,"top","0","bottom","0","margin","auto","right","13px",3,"click"],["tappable","",3,"click"],[1,"ion-padding"],["value","Normal","mode","ios",3,"ngModelChange","ngModel"],["value","Normal"],["value","Hybrid"],["value","Satellite"],["value","Terrain"],[1,"mt-3"],["value","all","mode","ios",3,"ngModelChange","ngModel"],["value","all"],["value","mine"],[1,"mt-3","flex","flex-row"],[1,"my-btn-login","my-btn-close-session","m-1",2,"height","45px","padding","4px","background","#fff","color","var(--ion-color-primary)",3,"click"],[1,"my-btn-login","text-da","my-btn-close-session","m-1",2,"height","45px","padding","4px",3,"click"],["slot","start",1,"H2-22-700"],["slot","end"],["color","light",3,"click"],["src","assets/images/SoundCollect/close.svg"],[1,"flex","flex-col","justify-center","gap-4","items-center",2,"padding","38px"],["width","146",3,"src"],[1,"H6-16-700-SpaceGrotesk"],[1,"H6-16-400-SpaceGrotesk"]],template:function(i,r){if(1&i){const s=e.RV6();e.j41(0,"ion-content",3)(1,"div",4),e.nrm(2,"capacitor-google-map",null,0),e.k0s(),e.j41(4,"div",5)(5,"div",6)(6,"div",7)(7,"input",8),e.nI1(8,"translate"),e.mxI("ngModelChange",function(u){return e.eBV(s),e.DH7(r.searchText,u)||(r.searchText=u),e.Njj(u)}),e.bIt("ngModelChange",function(){return e.eBV(s),e.Njj(r.searchLocations())}),e.k0s(),e.DNE(9,G,1,0,"ion-icon",9)(10,z,1,0,"ion-icon",10),e.k0s(),e.j41(11,"ion-list",11),e.DNE(12,V,2,1,"ion-item",12),e.k0s()(),e.j41(13,"div",13),e.nrm(14,"ion-icon",14),e.k0s(),e.j41(15,"ion-popover",15,1),e.bIt("didDismiss",function(){return e.eBV(s),e.Njj(r.optionsPopoverDismiss())}),e.DNE(17,$,42,32,"ng-template"),e.k0s(),e.nrm(18,"div",16),e.j41(19,"div",17)(20,"ion-text",18),e.EFF(21,"35 dBA"),e.k0s(),e.j41(22,"ion-text",18),e.EFF(23,"85 dBA"),e.k0s()()(),e.j41(24,"ion-modal",19,2),e.bIt("didDismiss",function(){return e.eBV(s),e.Njj(r.isOpenBadgeModal=!1)}),e.DNE(26,J,16,11,"ng-template"),e.k0s()()}2&i&&(e.Y8G("fullscreen",!0),e.R7$(7),e.FS9("placeholder",e.bMT(8,10,"home.search")),e.R50("ngModel",r.searchText),e.Y8G("ngClass",0===r.predictions.length?"inputSearchWithoutList":"inputSearchWithList")("ngStyle",0===r.predictions.length?e.lJ4(12,N):e.lJ4(13,W)),e.R7$(2),e.Y8G("ngIf",0===r.searchText.length),e.R7$(),e.Y8G("ngIf",r.searchText.length>0),e.R7$(),e.Y8G("hidden",0===r.predictions.length),e.R7$(),e.Y8G("ngForOf",r.predictions),e.R7$(12),e.Y8G("isOpen",r.isOpenBadgeModal&&r.level>0))},dependencies:[c.bv,c.Jm,c.QW,c.W9,c.iq,c.uz,c.he,c.nf,c.Gp,c.eP,c.IO,c.BC,c.ai,c.Sb,c.CF,c.Je,p.MD,p.YU,p.Sq,p.bT,p.B3,k.h,P.h,P.D9,I.YN,I.me,I.BC,I.vS],styles:[".my-bg-home[_ngcontent-%COMP%]{background-image:url(home-bg.9edb9ec87b3d8eac.svg);background-size:cover;background-repeat:no-repeat;background-position:center}capacitor-google-map[_ngcontent-%COMP%]{display:inline-block;width:100%;height:100%}ion-content[_ngcontent-%COMP%]{--background: transparent !important}body[_ngcontent-%COMP%]{background:transparent!important}ion-modal#modal-badge[_ngcontent-%COMP%]{--width: 90%;--height: 406px;--border-radius: 29px;--box-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);background:#fff}ion-modal#modal-badge[_ngcontent-%COMP%]::part(backdrop){background:#154c5166;opacity:1}ion-modal#modal-badge[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: white;--color: black}ion-list[_ngcontent-%COMP%]{--background: white !important}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: white !important;--ion-item-border-color: #6b7280;--border-color: #6b7280}#options-popover[_ngcontent-%COMP%]{--width: 96vw !important;--offset-x: 4px;--offset-y: 3px}"]}),n})()}}]);